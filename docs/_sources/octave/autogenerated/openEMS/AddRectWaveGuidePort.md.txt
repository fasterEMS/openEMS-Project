AddRectWaveGuidePort
====================
```{function}  AddRectWaveGuidePort( CSX, prio, portnr, start, stop, dir, a, b, mode_name, exc_amp, varargin )
```
Full definition:
```{code-block} matlab
function [CSX,port] = AddRectWaveGuidePort( CSX, prio, portnr, start, stop, dir, a, b, mode_name, exc_amp, varargin )
```

Create a rectangular waveguide port, including an optional excitation and probes

Note: - The excitation will be located at the start position in the given direction
      - The voltage and current probes at the stop position in the given direction

input:
- CSX:        complete CSX structure (must contain a mesh)
- prio:       priority of primitives
- start:      start coordinates of waveguide port box
- stop:       stop  coordinates of waveguide port box
- dir:        direction of port (0/1/2 or 'x'/'y'/'z'-direction)
- a,b:        rectangular waveguide width and height (in meter)
- mode_name:  mode name, e.g. 'TE11' or 'TM21'
- exc_amp:    excitation amplitude (set 0 to be passive)

optional (key/values):
- varargin:   optional additional excitations options, see also AddExcitation
- 'PortNamePrefix': a prefix to the port name

output:
- CSX:        modified CSX structure
- port:       port structure to use with calcPort

example:

    % create a TE10 circular waveguide mode, using cylindircal coordinates
    start=[mesh.r(1)   mesh.a(1)   0  ];
    stop =[mesh.r(end) mesh.a(end) 100];
    [CSX,port] = AddCircWaveGuidePort( CSX, 99, 1, start, stop, 320e-3, 'TE11', 0, 1);



-----------------------
(c) 2013 Thorsten Liebig (thorsten.liebig@gmx.de)

See also InitCSX, AddExcitation, calcWGPort, calcPort

