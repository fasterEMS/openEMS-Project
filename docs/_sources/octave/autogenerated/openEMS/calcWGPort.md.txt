calcWGPort
==========
```{function}  calcWGPort( port, SimDir, f, varargin)
```
Full definition:
```{code-block} matlab
[port] = calcWGPort( port, SimDir, f, varargin)
```

Calculate voltages and currents, the propagation constant beta
and the characteristic impedance ZL of the given waveguide port.

The port has to be created by e.g. AddWaveGuidePort().

input:
- port:       return value of e.g. AddWaveGuidePort()
- SimDir:     directory, where the simulation files are
- f:          frequency vector for DFT

variable input:
- 'RefImpedance':    use a given reference impedance to calculate inc and
                     ref voltages and currents
                     default is given port or calculated line impedance
- 'RefPlaneShift':   use a given reference plane shift from port beginning
                     for a desired phase correction
                     default is the measurement plane at the end of the
                     port
                     the plane shift has to be given in drawing units!
- 'RefractiveIndex': set a material refractive index
- 'SwitchDirection': 0/1, switch assumed direction of propagation

output:
  - output signals/values in time domain (TD):
    - port.ut.tot:    total voltage (time-domain)
    - port.ut.time:   voltage time vector
    - port.it.tot:    total current (time-domain)
    - port.it.time:   current time vector

  - output signals/values in frequency domain (FD):
    - port.f:                 the given frequency fector
    - port.uf.tot/inc/ref:    total, incoming and reflected voltage
    - port.if.tot/inc/ref:    total, incoming and reflected current
    - port.beta:              propagation constant
    - port.ZL:                characteristic line impedance
    - port.ZL_ref:            used reference impedance

example:

    port{1} = calcWGPort( port{1}, Sim_Path, f, 'RefImpedance', 50);



-----------------------
(C) 2013 Thorsten Liebig (thorsten.liebig@gmx.de)

See also AddWaveGuidePort, calcPort

